import tkinter as tk
from tkinter import filedialog
from disassembler import disassemble_file
from signature import detect_signature
from sandbox import run_in_sandbox
from behavior import monitor_behavior
from report import generate_report

def open_file_dialog():
    file_path = filedialog.askopenfilename()
    file_path_entry.delete(0, tk.END)
    file_path_entry.insert(0, file_path)

def analyze_file():
    file_path = file_path_entry.get()

    if disassemble_var.get():
        disassemble_file(file_path)

    if detect_signature_var.get():
        detect_signature(file_path)

    if sandbox_var.get():
        run_in_sandbox(file_path)

    if monitor_behavior_var.get():
        monitor_behavior(file_path)

    if generate_report_var.get():
        generate_report(file_path)

# Create the main application window
app = tk.Tk()
app.title("Malware Analysis Tool - GUI")

# Create GUI elements
file_path_label = tk.Label(app, text="Select a binary file:")
file_path_entry = tk.Entry(app, width=50)
browse_button = tk.Button(app, text="Browse", command=open_file_dialog)
analyze_button = tk.Button(app, text="Analyze", command=analyze_file)

disassemble_var = tk.IntVar()
disassemble_checkbox = tk.Checkbutton(app, text="Disassemble", variable=disassemble_var)

detect_signature_var = tk.IntVar()
detect_signature_checkbox = tk.Checkbutton(app, text="Detect Signature", variable=detect_signature_var)

sandbox_var = tk.IntVar()
sandbox_checkbox = tk.Checkbutton(app, text="Run in Sandbox", variable=sandbox_var)

monitor_behavior_var = tk.IntVar()
monitor_behavior_checkbox = tk.Checkbutton(app, text="Monitor Behavior", variable=monitor_behavior_var)

generate_report_var = tk.IntVar()
generate_report_checkbox = tk.Checkbutton(app, text="Generate Report", variable=generate_report_var)

# Arrange GUI elements using grid
file_path_label.grid(row=0, column=0)
file_path_entry.grid(row=0, column=1)
browse_button.grid(row=0, column=2)
analyze_button.grid(row=1, column=0, columnspan=3)
disassemble_checkbox.grid(row=2, column=0, columnspan=3)
detect_signature_checkbox.grid(row=3, column=0, columnspan=3)
sandbox_checkbox.grid(row=4, column=0, columnspan=3)
monitor_behavior_checkbox.grid(row=5, column=0, columnspan=3)
generate_report_checkbox.grid(row=6, column=0, columnspan=3)

app.mainloop()
